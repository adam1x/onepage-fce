function Course(t){this.year=t.year||"",this.section=t.section||"",this.type=t.type||"",this.courseid=t.courseid||"",this.resp_rate=t.resp_rate||"",this.semester=t.semester||"",this.name=t.name||"",this.enrollment=t.enrollment||"",this.co_taught=t.co_taught||"",this.department=t.department||"",this.responses=t.responses||"",this.instructor=t.instructor||"",this.questions=function(t){return q={},$.each(t.questions||{},function(t,e){e.body.startsWith("Q-")&&(q[e.body]=e.value)}),q}(t),this.getTable=function(){var t=[this.courseid,this.year,this.semester,this.instructor,normalizeScore(this.questions["Q-10"]),normalizeScore(this.questions["Q-09"]),normalizeScore(this.questions["Q-07"]),normalizeScore(this.questions["Q-02"]),this.questions["Q-01"],this.enrollment,this.resp_rate];return table="<tr><td>"+t.join("</td><td>")+"</td></tr>",table}}function normalizeScore(t){return Math.round(t/5*100)}function search(t){var e,r,s=t.match(/(\d{2})[-]?(\d{3})/);null!==s?e=s[1]+"-"+s[2]:r=t;var o,n="https://courseapi-scotty.rhcloud.com/fce/_search?size=300&sort=year:desc&default_operator=AND";e?o=n.concat("&q=courseid:",e):r&&(o=n.concat("&q=instructor:",r)),o&&$.getJSON(o,function(t){var e=[],r="<br/>";try{var s=t.hits.hits;0==t.hits.total&&(r="Nothing was found.");for(i in s)hit=s[i],course=new Course(hit._source),e.push(course.getTable())}catch(o){r="Some thing went wrong. "+o}$("#result-body").remove(),$("#prompt-text").remove(),$("<tbody/>",{id:"result-body",html:e.join("")}).appendTo("#search-result"),$("<p/>",{id:"prompt-text",html:r}).appendTo("#prompt-div"),$("#search-result").removeAttr("data-sortable-initialized"),Sortable.init()})}$(function(){$("#search-form").on("submit",function(t){t.preventDefault();var e=$("#search-form :input").val();search(e)})});
